<!--suppress JSAnnotator -->
<template>

  <div class="page" data-name="admin-posts">

    <div class="fab fab-extended fab-right-bottom">
      <a href="/admin/post/create">
        <i class="icon f7-icons">add</i>
        <div class="fab-text">Create Post</div>
      </a>
    </div>


    <div class="page-content infinite-scroll-content">
      <div class="block-title">Blog Posts</div>
      <div class="block">
        <div class="list virtual-list" id="blog-post-list">
        </div>
      </div>
    </div>
  
  </div>

</template>





<script>
  return {
    on: {
      pageInit: function(e, page) {
        const self = this
      },
      pageAfterOut: function (e, page) {
        let controller = window['adminPostController']
        controller.unloadInfiniteScroll()
      }
    },

    created: async function(e, page) {

      const self = this
      
      await window['Global'].loadComponentState(this, false)
      
      let controller = window['adminPostController']

      // Attach 'infinite' event handler
      this.$$('.infinite-scroll-content').on('infinite', async function () {
        await controller.infiniteScrollListener(self)
      })

      controller.virtualList = window['Global'].app.virtualList.create({
        el: '#blog-post-list',
        itemTemplate: window['Global'].adminPostResultTemplate,
        items: [],
        emptyTemplate: "<li>No posts</li>"
      })

      //Get the page
      this.$$('.infinite-scroll-content').trigger('infinite')

    }
  }
</script>