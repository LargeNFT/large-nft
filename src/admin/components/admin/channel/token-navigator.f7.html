<template>

    <div class="card" >
        <form class="card-content card-content-padding" @submit="${goTokenFormSubmit}">

          <div class="segmented">

            ${itemViewModel.previous ? $h`
              <a class="button button-outline" href="/admin/channel/show/${itemViewModel.channel._id}/${itemViewModel.previous}">
                <i class="icon f7-icons">arrow_left</i>
              </a>
            ` : $h`<span />`}
  
            <input type="number" class="goto-input" style="width: 60px; border: 1px solid #cccccc; display: inline-block;" value="${itemViewModel.item.tokenId}" min="0"  />
 
  
            ${itemViewModel.next ? $h`
              <a class="button button-outline" href="/admin/channel/show/${itemViewModel.channel._id}/${itemViewModel.next}" data-transition="f7-cover">
                <i class="f7-icons">arrow_right</i>
              </a>
            ` : $h`<span />`}


          </div>





        </form>
    </div>

</template>


<style>    
</style>

<script>

    import { ContainerService } from "../../../service/core/container-service"
    import { ItemService } from "../../../service/item-service"

    import { ItemRepository } from "../../../repository/item-repository"

    export default (props, { $, $on, $f7, $update }) => {

        let itemService = ContainerService.getInstance(ItemService)

        let channelId = props.channel
        let itemViewModel = props.item


        const goTokenFormSubmit = async (e) => {
          
          e.preventDefault()

          const val = $(e.currentTarget).children('.goto-input').val()

          console.log(val)

          //Look up item by tokenId
          let item = await itemService.getByTokenId(channelId, parseInt(val.toString()))


          if (item) {
            $f7.views.main.router.navigate(`/admin/channel/show/${channelId}/${parseInt(val.toString())}`)
          } else {
            $f7.dialog.alert("Invalid Page")
          }

        }


        return $render
    }

</script>